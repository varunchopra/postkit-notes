{% extends "base.html" %}

{% block title %}Share: {{ note.title }}{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Share "{{ note.title }}"</h1>
</div>

<div class="content-with-sidebar">
    <form method="post" action="{{ url_for('views.notes.grant_access', note_id=note.note_id) }}" class="content-main">
        <div class="form-group">
            <label>Share with</label>
            <div class="radio-group">
                <label class="radio-option">
                    <input type="radio" name="share_type" value="user" checked>
                    <span>User (by email)</span>
                </label>
                <label class="radio-option">
                    <input type="radio" name="share_type" value="team" {% if not teams %}disabled{% endif %}>
                    <span>Team</span>
                    {% if not teams %}<span class="radio-hint">(No teams available)</span>{% endif %}
                </label>
            </div>
        </div>

        <div class="form-group" id="user-input">
            <label for="email">Email address</label>
            <input type="email" id="email" name="email" placeholder="user@example.com">
        </div>

        <div class="form-group d-none" id="team-input">
            <label for="team_id">Select team</label>
            <select id="team_id" name="team_id">
                <option value="">Choose a team...</option>
                {% for team in teams %}
                <option value="{{ team.team_id }}">{{ team.name }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="permission">Permission level</label>
            <select id="permission" name="permission">
                <option value="view">Can view</option>
                <option value="edit">Can edit</option>
            </select>
            <small>Note: "Can edit" includes view access</small>
        </div>

        <div class="form-group">
            <label for="expires_days">Access expires</label>
            <select id="expires_days" name="expires_days">
                <option value="never">Never</option>
                <option value="1">In 1 day</option>
                <option value="7">In 7 days</option>
                <option value="30">In 30 days</option>
                <option value="90">In 90 days</option>
            </select>
        </div>

        <div class="form-actions">
            <a href="{{ url_for('views.notes.view', note_id=note.note_id) }}" class="btn">Cancel</a>
            <button type="submit" class="btn btn-primary">Share</button>
        </div>
    </form>

    <div class="content-sidebar">
        <div class="info-panel">
            <h3>About sharing</h3>
            <ul>
                <li><strong>Can view</strong> - User can read the note but not modify it</li>
                <li><strong>Can edit</strong> - User can read and modify the note (includes view access)</li>
            </ul>
            <p>Only you (the owner) can delete or share this note.</p>

            <div class="mt-3">
                <a href="{{ url_for('views.notes.access', note_id=note.note_id) }}">View who has access &rarr;</a>
            </div>
        </div>
    </div>
</div>

<div class="mt-3">
    <a href="{{ url_for('views.notes.view', note_id=note.note_id) }}">&larr; Back to Note</a>
</div>
{% endblock %}
