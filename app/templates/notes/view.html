{% extends "base.html" %}

{% block title %}{{ note.title }}{% endblock %}

{% block content %}
{% if is_external_share %}
<div class="alert alert-info-accent mb-2">
    <strong>External Share</strong> - This note is from <strong>{{ source_org_name }}</strong>
</div>
{% endif %}

<div class="page-header">
    <h1>{{ note.title }}</h1>
    <div class="actions">
        {% if can_edit %}
        <a href="{{ edit_url }}" class="btn">Edit</a>
        {% endif %}
        {% if can_share %}
        <a href="{{ url_for('views.notes.share', note_id=note.note_id) }}" class="btn btn-primary">Share</a>
        {% endif %}
    </div>
</div>

<div class="content-with-sidebar">
    <div class="content-main">
        <div class="note-body">{{ note.body or '(Empty note)' }}</div>
    </div>

    <div class="content-sidebar">
        <div class="sidebar-section">
            <h3>Details</h3>
            <div class="info-item">
                <span class="info-label">Owner</span>
                <span class="info-value">{{ note.owner_email }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Created</span>
                <span class="info-value">{{ note.created_at.strftime('%Y-%m-%d %H:%M') if note.created_at else 'N/A' }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Updated</span>
                <span class="info-value">{{ note.updated_at.strftime('%Y-%m-%d %H:%M') if note.updated_at else 'N/A' }}</span>
            </div>
        </div>

        {% if can_share %}
        <div class="sidebar-section">
            <h3>Sharing</h3>
            <a href="{{ url_for('views.notes.access', note_id=note.note_id) }}" class="btn btn-sm w-100">Who has access?</a>
            <a href="{{ url_for('views.notes.share', note_id=note.note_id) }}" class="btn btn-sm btn-primary w-100 mt-1">Share note</a>
        </div>
        {% endif %}

        {% if can_share %}
        <div class="sidebar-section danger-section">
            <h3>Danger Zone</h3>
            <form method="post" action="{{ url_for('views.notes.delete', note_id=note.note_id) }}">
                <button type="submit" class="btn btn-sm btn-danger w-100" data-confirm="Are you sure you want to delete this note? This cannot be undone.">Delete Note</button>
            </form>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
